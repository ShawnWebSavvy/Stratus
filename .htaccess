# compress text, html, javascript, css, xml:
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript

# Or, compress certain file types by extension:
<files *.html>
SetOutputFilter DEFLATE
</files>

<IfModule mod_gzip.c>
    mod_gzip_on       Yes
    mod_gzip_dechunk  Yes
    mod_gzip_item_include file      \.(html?|txt|css|js|php|pl|jpg|png|gif)$
    mod_gzip_item_include handler   ^cgi-script$
    mod_gzip_item_include mime      ^text/.*
    mod_gzip_item_include mime      ^application/x-javascript.*
    mod_gzip_item_exclude mime      ^image/.*
    mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</IfModule>

## Security Control ##
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak|tpl)$">
	Order Allow,Deny
	Deny from all
</FilesMatch>
<IfModule mod_security.c>
	SecFilterScanPOST Off
</IfModule>

## Cache Control ##
<IfModule mod_headers.c>
<FilesMatch "\.(jpg|jpeg|png|gif|svg|swf|css|js)$">
	Header set Cache-Control "max-age=31536000, public"
</FilesMatch>
</IfModule>

# ------------------------------------------------------------------------------
# | Compression                                                                |
# ------------------------------------------------------------------------------

<IfModule mod_deflate.c>

    # Force compression for mangled headers.
    # http://developer.yahoo.com/blogs/ydn/posts/2010/12/pushing-beyond-gzipping
    <IfModule mod_setenvif.c>
        <IfModule mod_headers.c>
            SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
            RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
        </IfModule>
    </IfModule>

    # Compress all output labeled with one of the following MIME-types
    # (for Apache versions below 2.3.7, you don't need to enable `mod_filter`
    #  and can remove the `<IfModule mod_filter.c>` and `</IfModule>` lines
    #  as `AddOutputFilterByType` is still in the core directives).
    <IfModule mod_filter.c>
        AddOutputFilterByType DEFLATE application/atom+xml \
                                      application/javascript \
                                      application/json \
                                      application/ld+json \
                                      application/rss+xml \
                                      application/vnd.ms-fontobject \
                                      application/x-font-ttf \
                                      application/x-web-app-manifest+json \
                                      application/xhtml+xml \
                                      application/xml \
                                      font/opentype \
                                      image/svg+xml \
                                      image/x-icon \
                                      text/css \
                                      text/html \
                                      text/plain \
                                      text/x-component \
                                      text/xml
    </IfModule>

</IfModule>
<ifModule mod_gzip.c>
  mod_gzip_on Yes
  mod_gzip_dechunk Yes
  mod_gzip_item_include file \.(html?|txt|css|js|php|pl)$
  mod_gzip_item_include handler ^cgi-script$
  mod_gzip_item_include mime ^text/.*
  mod_gzip_item_include mime ^application/javascript.*
  mod_gzip_item_include mime ^application/x-javascript.*
  mod_gzip_item_exclude mime ^image/.*
  mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</ifModule>
<ifModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 seconds"
  ExpiresByType text/html "access plus 1 seconds"
  ExpiresByType image/gif "access 1 year"
  ExpiresByType image/jpeg "access 1 year"
  ExpiresByType image/png "access 1 year"
  ExpiresByType image/svg+xml "access 1 year"
  ExpiresByType text/css "access plus 604800 seconds"
  ExpiresByType text/javascript "access plus 216000 seconds"
  ExpiresByType application/javascript "access plus 216000 seconds"
  ExpiresByType application/x-javascript "access plus 216000 seconds"
</ifModule>
<ifModule mod_headers.c>
  <filesMatch "\\.(ico|pdf|flv|jpg|jpeg|png|svg|gif|swf)$">
    Header set Cache-Control "max-age=2592000, public"
  </filesMatch>
  <filesMatch "\\.(css)$">
    Header set Cache-Control "max-age=604800, public"
  </filesMatch>
  <filesMatch "\\.(js)$">
    Header set Cache-Control "max-age=216000, private"
  </filesMatch>
  <filesMatch "\\.(xml|txt)$">
    Header set Cache-Control "max-age=216000, public, must-revalidate"
  </filesMatch>
  <filesMatch "\\.(html|htm|php)$">
    Header set Cache-Control "max-age=1, private, must-revalidate"
  </filesMatch>
</ifModule>
<ifModule mod_headers.c>
  Header unset ETag
</ifModule>
FileETag None
<ifModule mod_headers.c>
  Header unset Last-Modified
</ifModule>
## EXPIRES HEADER CACHING ##
<IfModule mod_expires.c>
ExpiresActive On
ExpiresByType image/jpg "access 1 year"
ExpiresByType image/jpeg "access 1 year"
ExpiresByType image/gif "access 1 year"
ExpiresByType image/png "access 1 year"
ExpiresByType image/svg+xml "access 1 year"
ExpiresByType text/css "access 1 month"
ExpiresByType application/pdf "access 1 month"
ExpiresByType application/javascript "access 1 month"
ExpiresByType application/x-javascript "access 1 month"
ExpiresByType application/x-shockwave-flash "access 1 month"
ExpiresByType image/x-icon "access 1 year"
ExpiresDefault "access 2 days"
</IfModule>
## EXPIRES HEADER CACHING ##
## RewriteEngine ##
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule .* - [L,QSA]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Installer
RewriteRule ^install/?$ install.php [L,QSA]

# Static Pages
RewriteRule ^static/([^/]+)/?$ static.php?url=$1 [L,QSA]

# Go Live
RewriteRule ^live/?$ live.php [L,QSA]


# Contacts
RewriteRule ^contacts/?$ contact.php [L,QSA]

#Landing Page
RewriteRule ^convenience/?$ new-landing-page.php?do=conv [L,QSA]
RewriteRule ^data-privacy/?$ new-landing-page.php?do=dataPriv [L,QSA]
RewriteRule ^fraud-leaks/?$ new-landing-page.php?do=fraud [L,QSA]
RewriteRule ^anonymous-bullies/?$ new-landing-page.php?do=bullies [L,QSA]
RewriteRule ^monetization/?$ new-landing-page.php?do=monetization [L,QSA]
RewriteRule ^censorship/?$ new-landing-page.php?do=censor [L,QSA]
RewriteRule ^independent-fact-checkers/?$ new-landing-page.php?do=checkers [L,QSA]


# Developers
RewriteRule ^api/([^/]+)/?$ api.php?do=$1 [L,QSA]
RewriteRule ^developers/?$ developers.php [L,QSA]
RewriteRule ^developers/([^/]+)/?$ developers.php?view=$1 [L,QSA]
RewriteRule ^developers/edit/([^/]+)/?$ developers.php?view=edit&app_auth_id=$1 [L,QSA]
RewriteRule ^share/?$ share.php [L,QSA]
RewriteRule ^web-api/([^/]+)/?$ web_api.php?endpoint=$1 [L,QSA]
RewriteRule ^authorize-payment/([^/]+)/?$ authorize_payment.php [L,QSA]

# Directory
RewriteRule ^directory/?$ directory.php [L,QSA]
RewriteRule ^directory/([^/]+)/?$ directory.php?view=$1 [L,QSA]
RewriteRule ^directory/([^/]+)/([^/]+)/?$ directory.php?view=$1&page=$2 [L,QSA]

# Search
RewriteRule ^search/?$ search.php [L,QSA]
RewriteRule ^search/hashtag/([^/]+)/?$ search.php?query=$1&hashtag=1 [L,QSA]
RewriteRule ^search/([^/]+)/?$ search.php?query=$1&hashtag=0 [L,QSA]


# globalhub-search
RewriteRule ^globalhub-search/?$ globalhub-search.php [L,QSA]
RewriteRule ^globalhub-search/hashtag/([^/]+)/?$ globalhub-search.php?query=$1&hashtag=1 [L,QSA]
RewriteRule ^globalhub-search/([^/]+)/?$ globalhub-search.php?query=$1&hashtag=0 [L,QSA]


# Sign(in|up|out)
RewriteRule ^signin/?$ sign.php?do=in [L,QSA]
RewriteRule ^signup/?$ sign.php?do=up [L,QSA]
RewriteRule ^signout/?$ sign.php?do=out [L,QSA]
RewriteRule ^reset/?$ sign.php?do=reset [L,QSA]
#RewriteRule ^activation/([^/]+)/([^/]+)/?$ activation.php?user_id=$1&code=$2 [L,QSA]
RewriteRule ^activation/([^/]+)/?$ activation.php?code=$1 [L,QSA]

# Social Logins
RewriteRule ^connect/([^/]+)/?$ connect.php?do=connect&provider=$1 [L,QSA]
RewriteRule ^revoke/([^/]+)/?$ connect.php?do=revoke&provider=$1 [L,QSA]

# Packages
RewriteRule ^packages/?$ packages.php [L,QSA]

# Started
RewriteRule ^started/?$ started.php [L,QSA]
RewriteRule ^started/finished?$ started.php?finished=true [L,QSA]

# Messages
RewriteRule ^messages/?$ messages.php [L,QSA]
RewriteRule ^messages/new?$ messages.php?view=new [L,QSA]
RewriteRule ^messages/([^/]+)/?$ messages.php?cid=$1 [L,QSA]

# MessagesGlobal
RewriteRule ^globalMessages/?$ messages_global.php [L,QSA]
RewriteRule ^globalMessages/new?$ messages_global.php?view=new [L,QSA]
RewriteRule ^globalMessages/([^/]+)/?$ messages_global.php?cid=$1 [L,QSA]

# Notifications
RewriteRule ^notifications/?$ notifications.php [L,QSA]

# Settings
RewriteRule ^settings/?$ settings.php [L,QSA]
RewriteRule ^settings/([^/]+)/?$ settings.php?view=$1 [L,QSA]
RewriteRule ^settings/([^/]+)/([^/]+)/?$ settings.php?view=$1&sub_view=$2 [L,QSA]

# Posts & Photos
RewriteRule ^posts/([^/]+)/?$ post.php?post_id=$1 [L,QSA]
RewriteRule ^photos/([^/]+)/?$ photo.php?photo_id=$1 [L,QSA]

# Global Posts & Photos
RewriteRule ^global-profile-posts/([^/]+)/?$ global-profile-post.php?post_id=$1 [L,QSA]
RewriteRule ^global-profile-photo/([^/]+)/?$ global-profile-photo.php?photo_id=$1 [L,QSA]
RewriteRule ^global-profile-bookmarks/([^/]+)/?$ global-profile-bookmarks.php [L,QSA]

# Compress Images Greater Than 1 MB
RewriteRule ^compress/?$ image_compress.php [L,QSA]

# Popular
RewriteRule ^popular/?$ index.php?view=popular [L,QSA]

# Discover
RewriteRule ^discover/?$ index.php?view=discover [L,QSA]

# Saved
RewriteRule ^saved/?$ index.php?view=saved [L,QSA]

# Memories
RewriteRule ^memories/?$ index.php?view=memories [L,QSA]

# landingPage
RewriteRule ^landingpage/?$ landingpage.php [L,QSA]

# GloBalProfile
RewriteRule ^global-profile-timeline/?$ global-profile-timeline.php [L,QSA]

# GloBalProfile
RewriteRule ^global-profile/?$ global-profile.php [L,QSA]
RewriteRule ^global-profile/([^/]+)/?$ global-profile.php?username=$1 [L,QSA]
RewriteRule ^global-profile/([^/]+)/([^/]+)/?$ global-profile.php?username=$1&view=$2 [L,QSA]
RewriteRule ^global-profile/([^/]+)/([^/]+)/([^/]+)/?$ global-profile.php?username=$1&view=$2&id=$3 [L,QSA]

# Ads
RewriteRule ^ads/?$ ads.php [L,QSA]
RewriteRule ^ads/new?$ ads.php?view=new [L,QSA]
RewriteRule ^ads/edit/([^/]+)/?$ ads.php?view=edit&campaign_id=$1 [L,QSA]
RewriteRule ^wallet/?$ ads.php?view=wallet [L,QSA]

# Investments
RewriteRule ^investments/?$ investment.php [L,QSA]

RewriteRule ^investment-cron/?$ investment-referral-cron.php [L,QSA]

RewriteRule ^investment/activities?$ investment.php?view=investment_activities [L,QSA]
RewriteRule ^investment/buy-sell/?$ investment.php?view=coin_buy_sell [L,QSA]

# Boosted
RewriteRule ^boosted/posts/?$ index.php?view=boosted_posts [L,QSA]
RewriteRule ^boosted/pages/?$ index.php?view=boosted_pages [L,QSA]

# People
RewriteRule ^people/?$ people.php [L,QSA]
RewriteRule ^people/find/?$ people.php?view=find [L,QSA]
RewriteRule ^people/friend_requests/?$ people.php?view=friend_requests [L,QSA]
RewriteRule ^people/sent_requests/?$ people.php?view=sent_requests [L,QSA]

RewriteRule ^people-global/?$ people-global.php [L,QSA]

# GlobalSearch
RewriteRule ^global/explore/?$ explore.php?view=foryou [L,QSA]
RewriteRule ^global/explore/trending?$ explore.php?view=trending [L,QSA]
RewriteRule ^global/explore/hashtag/([^/]+)/?$ explore.php?view=$1 [L,QSA]
RewriteRule ^global/explore/users?$ explore.php?view=users [L,QSA]
RewriteRule ^global-people/search/?$ explore.php?view=users&search=find [L,QSA]

# Pages
RewriteRule ^pages/?$ pages.php [L,QSA]
RewriteRule ^pages/liked/?$ pages.php?view=liked [L,QSA]
RewriteRule ^pages/manage/?$ pages.php?view=manage [L,QSA]
RewriteRule ^pages/([^/]+)/?$ page.php?username=$1 [L,QSA]
RewriteRule ^pages/([^/]+)/([^/]+)/?$ page.php?username=$1&view=$2 [L,QSA]
RewriteRule ^pages/([^/]+)/([^/]+)/([^/]+)/?$ page.php?username=$1&view=$2&id=$3 [L,QSA]

# Groups
RewriteRule ^groups/?$ groups.php [L,QSA]
RewriteRule ^groups/joined/?$ groups.php?view=joined [L,QSA]
RewriteRule ^groups/manage/?$ groups.php?view=manage [L,QSA]
RewriteRule ^groups/([^/]+)/?$ group.php?username=$1 [L,QSA]
RewriteRule ^groups/([^/]+)/([^/]+)/?$ group.php?username=$1&view=$2 [L,QSA]
RewriteRule ^groups/([^/]+)/([^/]+)/([^/]+)/?$ group.php?username=$1&view=$2&id=$3 [L,QSA]

# Events
RewriteRule ^events/?$ events.php [L,QSA]
RewriteRule ^events/going/?$ events.php?view=going [L,QSA]
RewriteRule ^events/interested/?$ events.php?view=interested [L,QSA]
RewriteRule ^events/invited/?$ events.php?view=invited [L,QSA]
RewriteRule ^events/manage/?$ events.php?view=manage [L,QSA]
RewriteRule ^events/([^/]+)/?$ event.php?event_id=$1 [L,QSA]
RewriteRule ^events/([^/]+)/([^/]+)/?$ event.php?event_id=$1&view=$2 [L,QSA]
RewriteRule ^events/([^/]+)/([^/]+)/([^/]+)/?$ event.php?event_id=$1&view=$2&id=$3 [L,QSA]

# Blogs
RewriteRule ^articles/?$ index.php?view=articles [L,QSA]
RewriteRule ^blogs/?$ blogs.php [L,QSA]
RewriteRule ^blogs/new/?$ blogs.php?view=new [L,QSA]
RewriteRule ^blogs/edit/([^/]+)/?$ blogs.php?view=edit&post_id=$1 [L,QSA]
RewriteRule ^blogs/category/([^/]+)/([^/]+)/?$ blogs.php?view=category&category_id=$1 [L,QSA]
RewriteRule ^blogs/([^/]+)/([^/]+)/?$ blogs.php?view=article&post_id=$1 [L,QSA]

# Market
RewriteRule ^products/?$ index.php?view=products [L,QSA]
RewriteRule ^market/?$ market.php [L,QSA]
RewriteRule ^market/search/?$ market.php?view=search [L,QSA]
RewriteRule ^market/search/([^/]+)/?$ market.php?view=search&query=$1 [L,QSA]
RewriteRule ^market/search/([^/]+)/([^/]+)/?$ market.php?view=search&query=$1&page=$2 [L,QSA]
RewriteRule ^market/category/([^/]+)/?$ market.php?view=category&category_id=$1 [L,QSA]
RewriteRule ^market/category/([^/]+)/([^/]+)/?$ market.php?view=category&category_id=$1&category_url=$2 [L,QSA]
RewriteRule ^market/category/([^/]+)/([^/]+)/([^/]+)/?$ market.php?view=category&category_id=$1&category_url=$2&page=$3 [L,QSA]
RewriteRule ^market/([^/]+)/?$ market.php?page=$1 [L,QSA]

# Forums
RewriteRule ^forums/?$ forums.php [L,QSA]
RewriteRule ^forums/my-threads/?$ forums.php?view=my-threads [L,QSA]
RewriteRule ^forums/my-replies/?$ forums.php?view=my-replies [L,QSA]
RewriteRule ^forums/search/?$ forums.php?view=search [L,QSA]
RewriteRule ^forums/search-results/?$ forums.php?view=search-results [L,QSA]
RewriteRule ^forums/new-thread/([^/]+)/?$ forums.php?view=new-thread&forum_id=$1 [L,QSA]
RewriteRule ^forums/edit-thread/([^/]+)/?$ forums.php?view=edit-thread&thread_id=$1 [L,QSA]
RewriteRule ^forums/new-reply/([^/]+)/?$ forums.php?view=new-reply&thread_id=$1 [L,QSA]
RewriteRule ^forums/edit-reply/([^/]+)/?$ forums.php?view=edit-reply&reply_id=$1 [L,QSA]
RewriteRule ^forums/thread/([^/]+)/([^/]+)/?$ forums.php?view=thread&thread_id=$1 [L,QSA]
RewriteRule ^forums/([^/]+)/([^/]+)/?$ forums.php?view=forum&forum_id=$1 [L,QSA]

# Movies
RewriteRule ^movies/?$ movies.php [L,QSA]
RewriteRule ^movies/search/?$ movies.php?view=search [L,QSA]
RewriteRule ^movies/search/([^/]+)/?$ movies.php?view=search&query=$1 [L,QSA]
RewriteRule ^movies/search/([^/]+)/([^/]+)/?$ movies.php?view=search&query=$1&page=$2 [L,QSA]
RewriteRule ^movies/genre/([^/]+)/([^/]+)/?$ movies.php?view=genre&genre_id=$1 [L,QSA]
RewriteRule ^movies/genre/([^/]+)/([^/]+)/([^/]+)/?$ movies.php?view=genre&genre_id=$1&page=$3 [L,QSA]
RewriteRule ^movies/([^/]+)/?$ movies.php?page=$1 [L,QSA]
RewriteRule ^movie/([^/]+)/([^/]+)/?$ movies.php?view=movie&movie_id=$1 [L,QSA]

# Games
RewriteRule ^games/?$ games.php [L,QSA]
RewriteRule ^games/played/?$ games.php?view=played [L,QSA]
RewriteRule ^games/([^/]+)/([^/]+)/?$ games.php?view=game&game_id=$1 [L,QSA]

# Moderator Panel
RewriteRule ^modcp/?$ moderator.php [L,QSA]
RewriteRule ^modcp/([^/]+)/?$ moderator.php?view=$1 [L,QSA]
RewriteRule ^modcp/([^/]+)/([^/]+)/?$ moderator.php?view=$1&sub_view=$2 [L,QSA]
RewriteRule ^modcp/([^/]+)/([^/]+)/([^/]+)/?$ moderator.php?view=$1&sub_view=$2&id=$3 [L,QSA]

# Admin Panel
RewriteRule ^admincp/?$ admin.php [L,QSA]
RewriteRule ^admincp/([^/]+)/?$ admin.php?view=$1 [L,QSA]
RewriteRule ^admincp/([^/]+)/([^/]+)/?$ admin.php?view=$1&sub_view=$2 [L,QSA]
RewriteRule ^admincp/([^/]+)/([^/]+)/([^/]+)/?$ admin.php?view=$1&sub_view=$2&id=$3 [L,QSA]

# Profile
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/?$ profile.php?username=$1 [L,QSA]
RewriteRule ^([^/]+)/([^/]+)/?$ profile.php?username=$1&view=$2 [L,QSA]
RewriteRule ^([^/]+)/([^/]+)/?$ global-profile.php?username=$1&view=$2 [L,QSA]
RewriteRule ^([^/]+)/([^/]+)/([^/]+)/?$ profile.php?username=$1&view=$2&id=$3 [L,QSA]
RewriteRule ^favourites/?$ landingpage.php [L,QSA]
